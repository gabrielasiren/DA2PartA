---
title: "Data Analytics II: Project Part A"
author: |
    | 57
    | Gabriela Siren, Didrik Gentili, Anna Gao, Ludwig Fredriksson
    | 25601, 25550, 25811, XXXXX
date: "2023-01-29"
output: pdf_document
df_print: paged
geometry: margin=2cm
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(readxl)
library(kableExtra)
library(ggplot2)
library(tibble)
library(rmarkdown)
library(knitr)
library(tidyverse)
library(tinytex)
```


```{r setup Importing data}
data <- read_excel("SegmentData57.xlsx")
```

## A.1 - Explorative Data Analysis (EDA)

```{r A.1.1 Statistics table: numerical variable and proportion}
stats <- function(x){c("Mean " = mean(x)
                       ,"Stan. Deviaton " = sd(x)
                       ,"Minimum " = min(x)
                       , "Q1 " = quantile(x,probs=0.25)
                       ," Median " = median(x)
                       , "Q3 " = quantile(x, probs = 0.75)
                       ,"Maximum " = max(x))}
summaryStatsTable <-sapply(c(data[1:1], data[3:4]),stats)

# I calculated the values and then input them since we only have to upload the pdf and not our code

H0 <- c(0.5233, 0.51667, 0.86667)
H1 <- c(0.47667, 0.48333, 0.13333)
categories <- rbind(H0,H1)
rownames(categories) = c("Female/False", "Male/True")

kables(
  list(
    kable(
      summaryStatsTable, digits = 2, col.names= c("Age","Income", "Kids"), valign = "t", booktabs = "True"
      )
  ,
    kable(
      categories, col.names = c("Gender","OwnsHome", "Subscribes"), valign = "t", booktabs = "True"
      )
  ),
  caption = "Summary table for all variables",
)
```
This table tells me...

```{r A.1.1 Numerical variables by segment} 
ageSM <- data %>%
  group_by("Segment" =data$Segment) %>%
    summarise("Mean"=mean(data$age),
              "StDev"= sd(data$age),
               "Minimum"= min(data$age),
               "Maximum"= max(data$age),
              "Q1" = quantile(data$age,probs=0.25),
              "Median"= median(data$age),
               "Q3" = quantile(data$age,probs=0.75))
kable(ageSM, caption = "Summary table for age")

incomeSM <- data %>%
  group_by("Segment" =data$Segment) %>%
    summarise("Mean"=mean(data$income),
              "StDev"= sd(data$income),
               "Minimum"= min(data$income),
               "Maximum"= max(data$income),
              "Q1" = quantile(data$income,probs=0.25),
              "Median"= median(data$income),
               "Q3" = quantile(data$income,probs=0.75))
kable(incomeSM, caption = "Summary table for income")

kidsSM <- data %>%
  group_by("Segment" =data$Segment) %>%
    summarise("Mean"=mean(data$kids),
              "StDev"= sd(data$kids),
               "Minimum"= min(data$kids),
               "Maximum"= max(data$kids),
              "Q1" = quantile(data$kids,probs=0.25),
              "Median"= median(data$kids),
               "Q3" = quantile(data$kids,probs=0.75))
kable(kidsSM, caption = "Summary table for children")

```

[your comments here]

```{r A.1.2}

```

[your comments here]

```{r A.1.3}

```

Do the variables Income and Age appear to be (approximately) normally distributed? 

Can you think of a suitable distribution for the variable children? 


## A.2 - Confidence Intervals

```{r A.2.1}

```

[your comments here]

```{r A.2.2}

```

[your comments here]

```{r A.2.3}

```

Are the underlying assumptions for calculating this interval met in this data? 

## A.3 - Confidence Intervals and the Sample Size

```{r A.3.1}

```

[your comments here]

```{r A.3.2}

```

How should we adjust the confidence level as the size of the sample increases? Why?


## A.4 - Confidence Intervals: Comparison of Population Means

```{r A.4.i}

```

[your comments here]

Are underlying assumptions used to calculate this interval met in this data?

